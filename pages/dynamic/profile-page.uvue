<template>
	<scroll-view class="root">
		<view class="container">

			<!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ -->
			<view class="profile-section">
				<view v-if="!isLoggedIn" class="login-section">
					<view class="avatar">
						<text class="icon">ğŸ‘¤</text>
					</view>
					<text class="login-text">ç™»å½•åæŸ¥çœ‹ä¸ªäººä¿¡æ¯</text>
					<view class="login-btn" @tap="goToLogin">
						<text class="login-btn-text">ç«‹å³ç™»å½•</text>
					</view>
				</view>
				
				<view v-else>
					<view class="avatar">
						<text class="icon">ğŸ‘¤</text>
					</view>

					<view class="user-info" @tap="goEdit">
						<text class="username">ææ˜åŒå­¦</text>
						<text class="edit-icon">âœï¸</text>
					</view>

				<text class="user-tagline">â€œä¸“æ³¨å¤‡è€ƒ100å¤©â€</text>

				<view class="stats-container">
					<view class="stat-item">
						<text class="stat-value">VIP</text>
						<text class="stat-label">ä¼šå‘˜</text>
					</view>
					<view class="stat-item">
						<text class="stat-value">8</text>
						<text class="stat-label">å‹‹ç« </text>
					</view>
					<view class="stat-item stat-item-last">
						<text class="stat-value">100</text>
						<text class="stat-label">å­¦ä¹ å¤©æ•°</text>
					</view>
				</view>

				<view class="vip-badge">ä¼šå‘˜ç‰¹æƒ</view>
			</view>

			<!-- æ•°æ®å¡ç‰‡åŒºåŸŸ -->
			<view class="data-cards">
				<view class="data-card" @tap="goDetail('æ—¶é•¿')">
					<text class="data-value">100h</text>
					<text class="data-label">å­¦ä¹ æ—¶é•¿</text>
				</view>
				<view class="data-card" @tap="goDetail('æ­£ç¡®ç‡')">
					<text class="data-value">85%</text>
					<text class="data-label">æ­£ç¡®ç‡</text>
				</view>
				<view class="data-card data-card-last" @tap="goDetail('æ’å')">
					<text class="data-value">å‰10%</text>
					<text class="data-label">æ’å</text>
				</view>
			</view>

			<!-- åŠŸèƒ½å®«æ ¼å¯¼èˆª -->
			<view class="grid-nav">
				<view class="grid-item grid-item-1">
					<view class="grid-item-card" @tap="nav('course')">
						<view class="grid-icon">ğŸ“š</view>
						<text class="grid-label">æˆ‘çš„è¯¾ç¨‹</text>
					</view>
				</view>
				<view class="grid-item grid-item-2">
					<view class="grid-item-card" @tap="nav('wrong')">
						<view class="grid-icon">âŒ</view>
						<text class="grid-label">æˆ‘çš„é”™é¢˜</text>
					</view>
				</view>
				<view class="grid-item grid-item-3">
					<view class="grid-item-card" @tap="nav('star')">
						<view class="grid-icon">â­</view>
						<text class="grid-label">æˆ‘çš„æ”¶è—</text>
					</view>
				</view>
				<view class="grid-item grid-item-4">
					<view class="grid-item-card" @tap="nav('history')">
						<view class="grid-icon">ğŸ•’</view>
						<text class="grid-label">åšé¢˜å†å²</text>
					</view>
				</view>
				<view class="grid-item grid-item-5">
					<view class="grid-item-card" @tap="nav('note')">
						<view class="grid-icon">ğŸ“</view>
						<text class="grid-label">æˆ‘çš„ç¬”è®°</text>
					</view>
				</view>
				<view class="grid-item grid-item-6">
					<view class="grid-item-card" @tap="nav('vip')">
						<view class="grid-icon">ğŸ‘‘</view>
						<text class="grid-label">ä¼šå‘˜ä¸­å¿ƒ</text>
					</view>
				</view>
			</view>

			<!-- æˆå°±åŒºåŸŸ -->
			<view class="achievement-section">
				<view class="section-title">
					<text class="section-title-left">æˆ‘çš„æˆå°±</text>
					<text class="view-all" @tap="goAchieve">æŸ¥çœ‹å…¨éƒ¨</text>
				</view>
				<scroll-view class="badges-scroll">
					<view class="badges-list">
						<view class="badge earned">ğŸ†</view>
						<view class="badge earned">â­</view>
						<view class="badge earned">ğŸš€</view>
						<view class="badge locked">ğŸ”’</view>
						<view class="badge locked">ğŸ”’</view>
						<view class="badge locked">ğŸ”’</view>
					</view>
				</scroll-view>
			</view>

			<!-- è®¾ç½®åŒºåŸŸ -->
			<view class="settings-section">
				<view v-for="(item, idx) in settings" :key="idx" class="settings-item"
					:class="{'settings-item-last': idx === settings.length - 1}" @tap="item.action">
					<text class="settings-item-text" :class="{ logout: item.logout }">{{ item.text }}</text>
					<text class="arrow">â€º</text>
				</view>
			</view>

		</view>

		<BottomNav current="mine" />

	</scroll-view>
</template>

<script setup lang="uts">
	import { ref } from 'vue'

	const isLoggedIn = ref(false)
	const settings = ref([
		{ text: 'è®¾ç½®ä¸éšç§', action: () => uni.showToast({ title: 'è®¾ç½®é¡µ', icon: 'none' }) },
		{ text: 'å¸®åŠ©ä¸åé¦ˆ', action: () => uni.showToast({ title: 'å¸®åŠ©é¡µ', icon: 'none' }) },
		{ text: 'é‚€è¯·å¥½å‹å¾—ä¼šå‘˜', action: () => uni.showToast({ title: 'é‚€è¯·é¡µ', icon: 'none' }) },
		{ text: 'å…³äºæˆ‘ä»¬', action: () => uni.showToast({ title: 'å…³äºé¡µ', icon: 'none' }) },
		{ text: 'é€€å‡ºç™»å½•', logout: true, action: () => confirmLogout() }
	])

	const goToLogin = () => {
		uni.navigateTo({
			url: '/pages/dynamic/login-page'
		})
	}

	const nav = (page : string) => uni.showToast({ title: `è·³è½¬åˆ°${page}`, icon: 'none' })
	const goEdit = () => uni.showToast({ title: 'ç¼–è¾‘èµ„æ–™', icon: 'none' })
	const goDetail = (type : string) => uni.showToast({ title: `${type}è¯¦æƒ…`, icon: 'none' })
	const goAchieve = () => uni.showToast({ title: 'å…¨éƒ¨æˆå°±', icon: 'none' })

	const confirmLogout = () => {
		uni.showModal({
			title: 'é€€å‡ºç™»å½•',
			content: 'ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ',
			success: (res) => {
				if (res.confirm) uni.showToast({ title: 'å·²é€€å‡º', icon: 'success' })
			}
		})
	}
</script>

<style>
	.root {
		flex: 1;
		background: linear-gradient(to bottom right, #f8f9fc, #eef0f8);
	}

	.container {
		padding: 32rpx 32rpx 120rpx;
	}

	/* ç”¨æˆ·ä¿¡æ¯ */
	.profile-section {
		background: linear-gradient(to bottom, #fff, #f8f9fc);
		border-radius: 40rpx;
		padding: 48rpx;
		align-items: center;
		margin-bottom: 32rpx;
		border: 2rpx solid #e6e9f0;
	}

	.avatar {
		width: 160rpx;
		height: 160rpx;
		border-radius: 80rpx;
		background: linear-gradient(to bottom right, #3a397a, #4f4e8c);
		justify-content: center;
		align-items: center;
		margin-bottom: 32rpx;
		border: 6rpx solid #fff;
	}

	.icon {
		font-size: 64rpx;
		color: #fff;
	}

	.user-info {
		flex-direction: row;
		align-items: center;
		margin-bottom: 16rpx;
	}

	.username {
		font-size: 40rpx;
		font-weight: 600;
		color: #2c2c2c;
		margin-right: 16rpx;
	}

	.edit-icon {
		font-size: 32rpx;
		color: #3a397a;
	}

	.user-tagline {
		font-size: 28rpx;
		color: #6c757d;
		margin-bottom: 32rpx;
	}

	.stats-container {
		flex-direction: row;
	}

	.stat-item {
		flex: 1;
		align-items: center;
		padding: 0 32rpx;
		border-right: 2rpx solid #e6e9f0;
	}

	.stat-item-last {
		border-right: none;
	}

	.stat-value {
		font-size: 32rpx;
		font-weight: 600;
		color: #3a397a;
	}

	.stat-label {
		font-size: 24rpx;
		color: #6c757d;
	}

	.vip-badge {
		background: linear-gradient(to bottom right, #ff7e5f, #ff9a8b);
		color: #fff;
		padding: 8rpx 24rpx;
		border-radius: 40rpx;
		font-size: 24rpx;
		font-weight: 500;
		margin-top: 16rpx;
	}

	/* æ•°æ®å¡ç‰‡ */
	.data-cards {
		flex-direction: row;
		margin-bottom: 32rpx;
	}

	.data-card {
		flex: 1;
		background: linear-gradient(to bottom, #fff, #f8f9fc);
		border-radius: 24rpx;
		padding: 32rpx;
		align-items: center;
		margin-right: 16rpx;
		border: 2rpx solid #e6e9f0;
	}

	.data-card-last {
		margin-right: 0;
	}

	.data-value {
		font-size: 40rpx;
		font-weight: 600;
		color: #3a397a;
		margin-bottom: 8rpx;
	}

	.data-label {
		font-size: 24rpx;
		color: #6c757d;
	}

	/* å®«æ ¼å¯¼èˆª */
	.grid-nav {
		flex-direction: row;
		flex-wrap: wrap;
		margin-bottom: 32rpx;
	}

	.grid-item {
		width: 33%;
	}

	.grid-item-1,
	.grid-item-2,
	.grid-item-3 {
		padding-bottom: 8rpx;
	}

	.grid-item-4,
	.grid-item-5,
	.grid-item-6 {
		padding-top: 8rpx;
	}

	.grid-item-1,
	.grid-item-4 {
		padding-right: 8rpx;
	}

	.grid-item-2,
	.grid-item-5 {
		padding-left: 8rpx;
		padding-right: 8rpx;
	}

	.grid-item-3,
	.grid-item-6 {
		padding-left: 8rpx;
	}

	.grid-item-card {
		align-items: center;
		padding: 32rpx;
		border-radius: 24rpx;
		background: linear-gradient(to bottom, #fff, #f8f9fc);
		border: 2rpx solid #e6e9f0;
	}

	.grid-icon {
		width: 80rpx;
		height: 80rpx;
		border-radius: 40rpx;
		background-color: #e6e9ff;
		justify-content: center;
		align-items: center;
		color: #3a397a;
		font-size: 36rpx;
		margin-bottom: 16rpx;
	}

	.grid-label {
		font-size: 24rpx;
		color: #2c2c2c;
	}

	/* æˆå°±åŒºåŸŸ */
	.achievement-section {
		background: linear-gradient(to bottom, #fff, #f8f9fc);
		border-radius: 40rpx;
		padding: 40rpx;
		margin-bottom: 32rpx;
		border: 2rpx solid #e6e9f0;
	}

	.section-title {
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 32rpx;
	}

	.section-title-left {
		font-size: 36rpx;
		font-weight: 600;
		color: #3a397a;
	}

	.view-all {
		font-size: 24rpx;
		color: #6c757d;
	}

	.badges-scroll {
		flex-direction: row;
	}

	.badges-list {
		flex-direction: row;
	}

	.badge {
		width: 120rpx;
		height: 120rpx;
		border-radius: 50%;
		justify-content: center;
		align-items: center;
		font-size: 48rpx;
		margin-right: 24rpx;
	}

	.badge.earned {
		background: linear-gradient(to bottom, #e6e9ff, #d9dcf7);
		border: 2rpx solid #e6e9f0;
	}

	.badge.locked {
		background: linear-gradient(to bottom, #f0f2f7, #e6e9f0);
		color: #ced4da;
	}

	/* è®¾ç½®åˆ—è¡¨ */
	.settings-section {
		background: linear-gradient(to bottom, #fff, #f8f9fc);
		border-radius: 40rpx;
		border: 2rpx solid #e6e9f0;
		margin-bottom: 40rpx;
	}

	.settings-item {
		flex-direction: row;
		justify-content: space-between;
		align-items: center;
		padding: 32rpx 40rpx;
		border-bottom: 2rpx solid #e6e9f0;
	}

	.settings-item-last {
		border-bottom: none;
	}

	.settings-item-text {
		font-size: 32rpx;
		color: #2c2c2c;
	}

	.settings-item-text.logout {
		font-size: 32rpx;
		color: #ff7e5f;
	}

	.arrow {
		font-size: 40rpx;
		color: #6c757d;
	}

	/* ç™»å½•åŒºåŸŸæ ·å¼ */
	.login-section {
		align-items: center;
		padding: 48rpx;
	}

	.login-text {
		font-size: 32rpx;
		color: #6c757d;
		margin: 32rpx 0;
		text-align: center;
	}

	.login-btn {
		background: linear-gradient(to bottom right, #3a397a, #4f4e8c);
		border-radius: 40rpx;
		padding: 24rpx 48rpx;
		margin-top: 32rpx;
	}

	.login-btn-text {
		color: #fff;
		font-size: 32rpx;
		font-weight: 500;
	}
</style>